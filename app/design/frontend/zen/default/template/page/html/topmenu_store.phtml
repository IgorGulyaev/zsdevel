<div class="navbar-nav-container">
    <div class="container">
        <nav id="navbar" class="navbar">
            <ul class="nav navbar-nav">
                <?php
                foreach (Mage::app()->getWebsites() as $website) {
                    foreach ($website->getGroups() as $group) {
                        $stores = $group->getStores();
                        foreach ($stores as $store) {
                            if ($store->getId() == 1) {} else {
                                echo '<li class="dropdown-left level0 nav-1 level-top dropdown"><a href="'.$store['code'].'" class="level-top dropdown-toggle" data-hover="dropdown">'.$store->getName().'</a>';
                                echo '<ul class="level0 dropdown-menu">';
                                $rootId = $store->getRootCategoryId();
                                $collection = Mage::getModel('catalog/category')
                                    ->getResourceCollection()
                                    ->addAttributeToSelect('*')
                                    ->addFieldToFilter('path', array('like' => "1/{$rootId}/%"))
                                    ->addIsActiveFilter()
                                    ->addUrlRewriteToResult();
                                foreach ($collection as $cat) {
                                    $store_url   = Mage::app()->getStore($store->getId())->getBaseUrl(Mage_Core_Model_Store::URL_TYPE_LINK);

                                    $objcategory = $cat;
                                    $categoryId  = $objcategory->getId();
                                    $catEntity   = Mage::getModel('catalog/category')->setStoreId($store->getId())->load($categoryId);
                                    $caturlkey   = $catEntity->getUrlKey();
                                    $altUrl      = $store_url.$caturlkey;
                                    if ($catEntity->getChildren()) {
                                        echo '<li class="level'.$cat->getLevel().' nav-2 dropdown"><a href="'.$altUrl.'">'.$cat->getName().'</a>';
                                        echo '<ul class="level'.$cat->getLevel().' dropdown-menu">';
                                        $categories = Mage::getModel('catalog/category')->load($categoryId)->getChildren();
                                        $catArray = explode(',', $categories);
                                        foreach($catArray as $child)
                                        {
                                            $_child = Mage::getModel( 'catalog/category' )->load( $child );
                                            $objsub = $_child;
                                            $subId  = $objsub->getId();
                                            $subEntity   = Mage::getModel('catalog/category')->setStoreId($store->getId())->load($subId);
                                            $suburlkey   = $subEntity->getUrlKey();
                                            $altSubUrl   = $altUrl.$suburlkey;
                                            echo '<li class="level'.$cat->getLevel().' nav-2 dropdown"><a href="'.$altSubUrl.'">'.$_child->getName().'</a></li>';
                                        }
                                        echo '</ul>';
                                        echo '</li>';
                                    } else {
                                        echo '<li class="level-'.$cat->getLevel().'"><a href="'.$altUrl.'">'.$cat->getName().'</a></li>';
                                    }
                                }
                                echo '</ul>';
                                echo '</li>';
                            }
                        }
                    }
                }
                ?>
            </ul>
        </nav>
    </div>
</div>